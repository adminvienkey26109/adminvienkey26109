<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tool T√†i X·ªâu API v·ªõi Favicon chu·∫©n</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #222; color: #eee; text-align: center; }
    #dice { font-size: 50px; margin: 10px 0; }
    #result { font-size: 24px; margin: 10px 0; }
    #history { max-width: 600px; margin: 20px auto; text-align: left; }
    .history-item { background: #333; padding: 8px; margin: 5px 0; border-radius: 6px; }
    button { font-size: 16px; padding: 10px 20px; cursor: pointer; border-radius: 6px; border: none; background: #00bfff; color: white; }
    button:hover { background: #0099cc; }
  </style>

  <!-- Favicon tr·ªëng ƒë·ªÉ tr√°nh l·ªói -->
  <link rel="icon" href="data:," />
</head>
<body>

  <h1>Tool T√†i X·ªâu API (AllOrigins Proxy)</h1>
  <p>Phi√™n: <span id="phien">--</span></p>
  <div id="dice">üé≤üé≤üé≤</div>
  <div id="total">T·ªïng: --</div>
  <div id="result">K·∫øt qu·∫£: --</div>
  <button id="btnLoad">C·∫≠p nh·∫≠t phi√™n m·ªõi</button>

  <div id="history">
    <h3>L·ªãch s·ª≠</h3>
  </div>

<script>
  let history = [];

  async function loadData() {
    const api = "https://taixiu.system32-cloudfare-356783752985678522.monster/api/luckydice/GetSoiCau";
    // Th√™m timestamp ch·ªëng cache proxy
    const proxy = "https://api.allorigins.win/raw?url=" + encodeURIComponent(api) + "&timestamp=" + Date.now();

    try {
      const res = await fetch(proxy, { cache: "no-store" });
      const data = await res.json();

      if (!data.data || !data.data.length) {
        alert("Kh√¥ng nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu h·ª£p l·ªá");
        return;
      }

      const item = data.data[0];

      // Hi·ªÉn th·ªã k·∫øt qu·∫£
      document.getElementById("phien").textContent = item.phien;
      document.getElementById("dice").textContent = item.ketQua.split("-").map(_ => "üé≤").join("");
      document.getElementById("total").textContent = "T·ªïng: " + item.tong;
      document.getElementById("result").textContent = "K·∫øt qu·∫£: " + item.taiXiu;

      // Th√™m v√†o l·ªãch s·ª≠
      history.unshift({
        phien: item.phien,
        dice: item.ketQua,
        total: item.tong,
        result: item.taiXiu
      });
      if (history.length > 10) history.pop();

      renderHistory();

    } catch (e) {
      alert("L·ªói khi g·ªçi API ho·∫∑c proxy: " + e.message);
      console.error(e);
    }
  }

  function renderHistory() {
    const container = document.getElementById("history");
    container.innerHTML = "<h3>L·ªãch s·ª≠</h3>";
    history.forEach(h => {
      const div = document.createElement("div");
      div.className = "history-item";
      div.textContent = `Phi√™n ${h.phien} - Dice: ${h.dice} - T·ªïng: ${h.total} - K·∫øt qu·∫£: ${h.result}`;
      container.appendChild(div);
    });
  }

  document.getElementById("btnLoad").addEventListener("click", loadData);
</script>

</body>
</html>
